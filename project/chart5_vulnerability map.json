

  {"$schema": "https://vega.github.io/schema/vega-lite/v5.json",

  "title": {
    "text": "World Map Showing Climate Vulnerability & An Overall Risk Index",
    "subtitle":["In the Climate Vulnerability map, the higher the score, the more vulnerable a country is.",
    "In the Overall Risk Index, the lower the score, the worse the impact of climate change will be.",
    "Source: Notre Dame Global Adaption Initiative, Notre Dame Univeristy."],
    "subtitleFontStyle":"italic",
    "subtitleFontSize":10,
    "anchor": "start",
    "color": "black"
  },

  "view": {"fill":"rgb(210,230,250)"},

  "config": {
    "background":"white",
    "view": {"stroke": "trasparent"}},
  
  "width": 700,
  "height": 500,
  
  "data": {
    "url": "https://unpkg.com/world-atlas@1.1.4/world/110m.json",
        "format": {
          "type": "topojson",
          "feature": "countries"}
      },

  "projection": {
    "type": "naturalEarth1"},
  
  "mark": {
      "type": "geoshape",
      "stroke": "rgb(50, 50, 50)",
      "strokeWidth":0.3},

    "transform": [
      {"calculate":"parseInt(datum.id)", "as":"id_N"},
            {
    "lookup": "id_N",
    "from": {
          "key": "id",
          "fields": ["alpha3", "name"],
          "data": {"url": "https://raw.githubusercontent.com/RDeconomist/RDeconomist.github.io/main/charts/maps/dataWorldCountryNamesIDs.json"}}
          },
      
        {"lookup": "alpha3",

        "from":{
          "data":{
            "url":"https://raw.githubusercontent.com/REstavia/REstavia.github.io/main/Gain_Vulnerability.json"},
            "key": "ISO3",
            "fields":["Vulnerability", "Gain"]
        }
        },        
        {"calculate": "datum.Vulnerability", "as": "Climate Vulnerability"},
        {"calculate": "datum.Gain", "as": "Overall Risk Index"},
        {"calculate": "datum[Select]","as": "varSelected"}

      ],    

    "params": [
      {"name": "Select",
        "value": "Vulnerability",
        "bind": {
          "input": "select",
          "options": [
            "Climate Vulnerability",
            "Overall Risk Index"]}}],
  
  
  "encoding": {

    "color":{
      "field":"varSelected",
      "type":"quantitative",
      "title": null,
      "scale":{
        "scheme": {"name": "turbo", "count":5}
        }
          },

        "tooltip":[
        {"field":"name", "title":"Country"},
        {"field":"varSelected","title":"Score","type":"quantitative"}]

  }

  

}